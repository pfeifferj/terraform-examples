schemaVersion: 2.3.0
metadata:
  name: terraform-dev
  version: 1.0.0
  description: A devfile for Terraform development and testing.
  projectType: Infrastructure-as-Code
  language: HCL
  provider: Open Source
  tags: ['Terraform', 'IaC']
  displayName: Terraform Development Environment
  icon: https://www.terraform.io/assets/images/og-image-8b3e4f7d.png

components:
  - name: terraform
    container:
      image: hashicorp/terraform:latest
      command: ['sleep']
      args: ['infinity']
      memoryLimit: 512Mi
      mountSources: true
      volumeMounts:
        - name: terraform-vol
          path: /workspace
      endpoints:
        - name: terraform
          targetPort: 80
  - name: terraform-docs
    container:
      image: quay.io/terraform-docs/terraform-docs:latest
      memoryLimit: 512Mi
      mountSources: true
      volumeMounts:
        - name: terraform-vol
          path: /workspace
commands:
  - name: terraform-lint
    command: ["terraform", "fmt", "-check"]
    component: terraform
  - name: terraform-plan
    command: ["terraform", "plan"]
    component: terraform
  - name: terraform-docs
    command: ["terraform-docs", "markdown", "/workspace"]
    component: terraform-docs
volumes:
  - name: terraform-vol
    ephemeral: true
